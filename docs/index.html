---

title: CE1115 DSAI Project 


keywords: fastai
sidebar: home_sidebar

summary: "Data Science Project to build a movie tagline predictor. "
description: "Data Science Project to build a movie tagline predictor. "
nb_path: "index.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Project-motivation-and-utility">Project motivation and utility<a class="anchor-link" href="#Project-motivation-and-utility"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Ever found yourself staring at a certain movie tagline and wondering what on earth the directors were thinking about when they came up with it? Yes, we too. On the other hand, we've also often been on the other end of the spectrum, struggling to come up with creative titles for our projects or succinct one-liners to encapsulate our business pitches. Enter our movie tagline predictor, a model we have built which we hope will provide some enlightenment to the many lost souls described above. We believe that this model can be transferrable to other salient applications, such as the web-link summarization we often see accompanying our everyday Google searches.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Installation">Installation<a class="anchor-link" href="#Installation"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Package-install:">Package install:<a class="anchor-link" href="#Package-install:"> </a></h3><p>Run the following command to install the package from PyPI or conda.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>pip install DSAI_proj</code></p>
<p><code>conda install DSAI_proj</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Editable-Install:">Editable Install:<a class="anchor-link" href="#Editable-Install:"> </a></h3><p>1) Clone the repository locally and cd into it.</p>
<p>2) Create a virtual/conda/pipenv environment first.</p>
<p>3) Depending on which type of environment you are using, run one of the following commands:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>pip install -e</code></p>
<p><code>conda develop .</code></p>
<p><code>pipenv install -e</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data-Extraction">Data Extraction<a class="anchor-link" href="#Data-Extraction"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The main function in this package perform the following functions for data extraction via the TMDB API:</p>
<ul>
<li>Multi-threaded download of movie information via the extract_dataset_threaded function.</li>
<li>Saving the data to a raw_data.csv file.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Exploratory-Data-Analysis-&amp;-Visualization">Exploratory Data Analysis &amp; Visualization<a class="anchor-link" href="#Exploratory-Data-Analysis-&amp;-Visualization"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that we have our raw dataset to work with, we begin by looking at:</p>
<ul>
<li>The different types of data present.</li>
<li>How they might be relevant to our task.</li>
<li>Their respective distributions and whether there might be class imbalances.</li>
<li>Missing data and other considerations to be had later during cleaning.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data-Cleaning-and-Feature-Engineering">Data Cleaning and Feature Engineering<a class="anchor-link" href="#Data-Cleaning-and-Feature-Engineering"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>After the EDA step, we have generated insights from the data in terms of their distribution and relevance our overall task. The functions in this package we perform the following functions to clean and feature engineer the raw data:</p>
<ul>
<li>Drop columns which are irrelevant.</li>
<li>For columns/features with json objects, unpack the json objects into new columns.</li>
<li>For categorical features, ensure that they are categorized accordingly.</li>
<li>For datetime features, ensure that they are separated out into year, month and day before either being rescaled or binned.</li>
<li>Separate out examples with and without taglines.</li>
<li>Save the dataset into separate train, valid, test and tagless csv files.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Dataset">Dataset<a class="anchor-link" href="#Dataset"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We next create the Dataset class to encapsulate all the different types of data which we will be working with. We also add in augmentations and transformations including:</p>
<ul>
<li>Tokenization of text based on the text based encoder which we will be using (DistilBert).</li>
<li>RandomResizeCrop to resize all images to a standard size and crop them randomly.</li>
<li>Normalization and Standardization of all images on the imagenet dataset statistics.</li>
<li>Converting all features to Pytorch tensors. </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Modelling">Modelling<a class="anchor-link" href="#Modelling"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/DSAI_proj/model_diagram.jpg" alt=""></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Moving on, we model the problem by creating the architectures and modules required to map the various inputs to the predicted tagline. In our case, we will be using an encoder-decoder based structure, with the encoder consisting of separate networks for image, text and meta/tabular data respectively, while the decoder consists of a few transformer decoder layers and a linear layer to output the predicted sequence.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Training-and-Evaluation">Training and Evaluation<a class="anchor-link" href="#Training-and-Evaluation"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We leverage the famous FastAI library to help us with training. The library provides us with numerous benefits, including advanced training techniques using learning rate schedulers and discriminative learning rates, along with seamless integration of features such as mixed precision training in the case where our model might be too big for GPU memory.</p>
<p>We also run evaluation on our test set, as well as predict some examples from the tagless csv to see how our model might perform in real life.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Results-interpretation-and-recommendations">Results interpretation and recommendations<a class="anchor-link" href="#Results-interpretation-and-recommendations"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>TO-DO!!!</p>

</div>
</div>
</div>
</div>
 

