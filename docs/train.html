---

title: Train


keywords: fastai
sidebar: home_sidebar

summary: "Training and evaluation of the model using FastAI utilities"
description: "Training and evaluation of the model using FastAI utilities"
nb_path: "05_train.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 05_train.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First, let's create our loss function. This will tell our model how wrong it is by calculating how far the predictions are from the output. Here, we will use cross entropy loss as our criterion. We can do this by viewing each token as a separate class, and hence provide a one-for-one comparison of tokens at each position.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TagLineLoss" class="doc_header"><code>class</code> <code>TagLineLoss</code><a href="https://github.com/Benjamintdk/DSAI_proj/tree/main/DSAI_proj/train.py#L18" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TagLineLoss</code>() :: <code>Module</code></p>
</blockquote>
<p>Base class for all neural network modules.</p>
<p>Your models should also subclass this class.</p>
<p>Modules can also contain other Modules, allowing to nest them in
a tree structure. You can assign the submodules as regular attributes::</p>

<pre><code>import torch.nn as nn
import torch.nn.functional as F

class Model(nn.Module):
    def __init__(self):
        super(Model, self).__init__()
        self.conv1 = nn.Conv2d(1, 20, 5)
        self.conv2 = nn.Conv2d(20, 20, 5)

    def forward(self, x):
        x = F.relu(self.conv1(x))
        return F.relu(self.conv2(x))

</code></pre>
<p>Submodules assigned in this way will be registered, and will have their
parameters converted too when you call :meth:<code>to</code>, etc.</p>
<p>:ivar training: Boolean represents whether this module is in training or
                evaluation mode.
:vartype training: bool</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We also define a splitter which will group the parameters of the different models to allow for unfreezing of the layers subsequently.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="splitter_func" class="doc_header"><code>splitter_func</code><a href="https://github.com/Benjamintdk/DSAI_proj/tree/main/DSAI_proj/train.py#L30" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>splitter_func</code>(<strong><code>model</code></strong>:<code>Module</code>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Same as with the previously, let us create the datasets, then the dataloaders, and followed by the model.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tokenizer</span> <span class="o">=</span> <span class="n">DistilBertTokenizer</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s1">&#39;distilbert-base-uncased&#39;</span><span class="p">)</span>
<span class="n">poster_img_dir</span> <span class="o">=</span> <span class="s2">&quot;poster_img/&quot;</span>
<span class="n">backdrop_img_dir</span> <span class="o">=</span> <span class="s2">&quot;backdrop_img/&quot;</span>
<span class="n">input_max_length</span><span class="p">,</span> <span class="n">labels_max_length</span> <span class="o">=</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">10</span>
<span class="n">height</span> <span class="o">=</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">128</span>
<span class="n">mean</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.485</span><span class="p">,</span> <span class="mf">0.456</span><span class="p">,</span> <span class="mf">0.406</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.229</span><span class="p">,</span> <span class="mf">0.224</span><span class="p">,</span> <span class="mf">0.225</span><span class="p">]</span>
<span class="n">bs</span> <span class="o">=</span> <span class="mi">32</span>

<span class="n">tfms</span> <span class="o">=</span> <span class="n">Compose</span><span class="p">([</span><span class="n">Tokenize</span><span class="p">(</span><span class="n">tokenizer</span><span class="o">=</span><span class="n">tokenizer</span><span class="p">,</span> <span class="n">input_max_length</span><span class="o">=</span><span class="n">input_max_length</span><span class="p">,</span> <span class="n">labels_max_length</span><span class="o">=</span><span class="n">labels_max_length</span><span class="p">),</span>
                         <span class="n">RandomResizeCrop</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">Image</span><span class="o">.</span><span class="n">BILINEAR</span><span class="p">),</span>
                         <span class="n">ToTensor</span><span class="p">(),</span>
                         <span class="n">NormalizeStandardize</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="n">std</span><span class="p">)])</span>

<span class="n">train_ds</span> <span class="o">=</span> <span class="n">MovieDataset</span><span class="p">(</span><span class="n">poster_img_dir</span><span class="o">=</span><span class="n">poster_img_dir</span><span class="p">,</span>
                        <span class="n">backdrop_img_dir</span><span class="o">=</span><span class="n">backdrop_img_dir</span><span class="p">,</span>
                        <span class="n">ds_type</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">,</span>
                        <span class="n">transforms</span><span class="o">=</span><span class="n">tfms</span><span class="p">)</span>

<span class="n">valid_ds</span> <span class="o">=</span> <span class="n">MovieDataset</span><span class="p">(</span><span class="n">poster_img_dir</span><span class="o">=</span><span class="n">poster_img_dir</span><span class="p">,</span>
                        <span class="n">backdrop_img_dir</span><span class="o">=</span><span class="n">backdrop_img_dir</span><span class="p">,</span>
                        <span class="n">ds_type</span><span class="o">=</span><span class="s2">&quot;valid&quot;</span><span class="p">,</span>
                        <span class="n">transforms</span><span class="o">=</span><span class="n">tfms</span><span class="p">)</span>

<span class="n">dls</span> <span class="o">=</span> <span class="n">DataLoaders</span><span class="o">.</span><span class="n">from_dsets</span><span class="p">(</span><span class="n">train_ds</span><span class="p">,</span> <span class="n">valid_ds</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">bs</span><span class="p">)</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">TaglinePredictorModel</span><span class="p">(</span><span class="n">vocab_size</span><span class="o">=</span><span class="mi">30522</span><span class="p">,</span> <span class="n">meta_features</span><span class="o">=</span><span class="n">sample</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>train dataset created!
valid dataset created!
Model is created!
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we can begin the training. To do this, we leverage the FastAI library as a training vehicle as it provides many advanced training techniques at our fingertips with simple APIs.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">loss_func</span><span class="o">=</span><span class="n">TagLineLoss</span><span class="p">(),</span> <span class="n">opt_func</span><span class="o">=</span><span class="n">Adam</span><span class="p">,</span> <span class="n">splitter</span><span class="o">=</span><span class="n">splitter_func</span><span class="p">,</span> <span class="n">cbs</span><span class="o">=</span><span class="n">CudaCallback</span><span class="p">,</span> <span class="n">wd</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span><span class="o">.</span><span class="n">to_fp16</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SuggestedLRs(lr_min=0.005754399299621582, lr_steep=0.019054606556892395)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYgAAAEKCAYAAAAIO8L1AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjQuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/Z1A+gAAAACXBIWXMAAAsTAAALEwEAmpwYAAAgjElEQVR4nO3deZxcVZ338c+3qro76c4eQhACJAiyiGy2AWRRBxdAHkDciMwMzoRFdHQcZ5zR2XR89HGbGR0QhkURRAQZRpwgEWR4QLaEoaNEg4CBgBoWs3QSku7Q1VX1mz/qdqdpqjudpG9VV/X3/XrVq+qeusvvFun745xz7zmKCMzMzAbL1DoAMzMbm5wgzMysIicIMzOryAnCzMwqcoIwM7OKnCDMzKyiXK0DGE277bZbzJ07t9ZhmJnVjWXLlq2LiFmVvmuoBDF37lw6OjpqHYaZWd2Q9JuhvnMTk5mZVeQEYWZmFTlBmJlZRU4QZmZWkROEmZlVlFqCkHS1pDWSVgwo+6qkxyX9QtItkqYNse3Jkp6Q9KSkT6UVo5mZDS3NGsQ1wMmDyu4EDo2Iw4BfA58evJGkLHApcApwCLBA0iEpxmlmVrcefW4TP/312lT2nVqCiIh7gc5BZT+JiEKyuBSYU2HT+cCTEbEqIvLAjcAZacVpZlbPvrv0t/zVfyxPZd+17IP4U+DHFcr3An43YHl1UmZmZoPkCyWas+lcymuSICT9HVAArh+FfV0gqUNSx9q16VSzzMzGqnyxREuuQRKEpA8CpwHnROX5Tp8F9h6wPCcpqygiroyI9ohonzWr4nAiZmYNK18o0twICULSycBfA6dHRPcQqz0MHCBpnqRm4GxgUbViNDOrJ/lCqf4ShKQbgCXAgZJWS1oIfAOYDNwp6RFJlyfr7ilpMUDSif1nwB3AY8BNEfFoWnGamdWzfDG9PojURnONiAUVir81xLrPAacOWF4MLE4pNDOzhlGXNQgzM0ufE4SZmVXU02i3uZqZ2ehwDcLMzCrqcYIwM7NKGupBOTMzGz35QomWXDaVfTtBmJnVMfdBmJlZRWk+KOcEYWZWp4qloFgK1yDMzOzl8oUSgBOEmZm9XH+CcBOTmZkN1FMsAq5BmJnZIG5iMjOzinqSBOEH5czM7GXcB2FmZhW5icnMzCrKF50gzMysAjcxmZlZRX0JoqXJg/WZmdkAPa5BmJlZJe6DMDOzivJ+DsLMzCrxba5mZlZRvpCMxeQ+CDMzG6jHNQgzM6vETUxmZlZRvlhCglxGqezfCcLMrE7lC+X5qCUnCDMzG6CnUEqteQmcIMzM6la+WErtGQhwgjAzq1v5QomWXDrjMIEThJlZ3crXaxOTpKslrZG0YkDZeyU9KqkkqX2YbZ+R9EtJj0jqSCtGM7N61tdJnZY0axDXACcPKlsBnAXcO4Lt3xIRR0TEkInEzGw8yxfTrUHk0tpxRNwrae6gsseA1G7JMjMbT+q2iWkXBfATScskXTDcipIukNQhqWPt2rVVCs/MrPZ6CsW6bWLaFcdHxFHAKcBHJJ041IoRcWVEtEdE+6xZs6oXoZlZjY3LGkREPJu8rwFuAebXNiIzs7Fn3D0oJ6lN0uS+z8DbKXdum5nZAGl3Uqd5m+sNwBLgQEmrJS2U9C5Jq4Fjgdsk3ZGsu6ekxcmms4H7JS0H/ge4LSJuTytOM7N6lS+UaEmxDyLNu5gWDPHVLRXWfQ44Nfm8Cjg8rbjMzBrFuOyDMDOz7avbJiYzM0tXPT9JbWZmKcoXSrQ0OUGYmdkApVJQKAXNWY/mamZmA+SL6c5HDU4QZmZ1qafgBGFmZhX0FIqAE4SZmQ2ST2oQaT4o5wRhZlaH8m5iMjOzStxJbWZmFfXXINzEZGZmA7mJyczMKnKCMDOzinrcB2FmZpW4D8LMzCrqSxATPFifmZkNtK0G4cH6zMxsAI/FZGZmFeU9FpOZmVXiJ6nNzKwi38VkZmYV9SWIpqxSO4YThJlZHeoplmjOZZCcIMzMbIB8oZTqXBDgBGFmVpfyhVKqHdTgBGFmVpecIMzMrKJ80QnCzMwqyBdKqd7iCk4QZmZ1KV8o0ZLiQH3gBGFmVpd6XIMwM7NK6rqTWtLVktZIWjGg7L2SHpVUktQ+zLYnS3pC0pOSPpVWjGZm9ar8oFx6Q31DujWIa4CTB5WtAM4C7h1qI0lZ4FLgFOAQYIGkQ1KK0cysLtV1J3VE3At0Dip7LCKe2M6m84EnI2JVROSBG4EzUgrTzKwu5QtFWuq1iWkX7AX8bsDy6qTMzMwSfg5iBCRdIKlDUsfatWtrHY6ZWVXUdRPTLngW2HvA8pykrKKIuDIi2iOifdasWakHZ2Y2FtT1XUy74GHgAEnzJDUDZwOLahyTmdmYUtcJQtINwBLgQEmrJS2U9C5Jq4Fjgdsk3ZGsu6ekxQARUQD+DLgDeAy4KSIeTStOM7N6VI0+iFxaO46IBUN8dUuFdZ8DTh2wvBhYnFJoZmZ1rVQKeosxLvsgzMxsGPliebpRj8VkZmYv05PMR+0ahJmZvUw+SRBj4kE5SW2SMsnn10g6XVJTqpGZmVlFfU1MY+UupnuBCZL2An4C/BHlsZbMzKzK+moQYyVBKCK6KQ+0d1lEvBd4bXphmZnZUPoTRHZsjOYqSccC5wC3JWXpRmZmZhWNtRrEx4FPA7dExKOS9gPuTi0qMzMbUr5YBNJPECN6UC4ifgr8FCDprF4XER9LMzAzM6tsTN3mKul7kqZIaqM86c+vJH0y1cjMzKyisdbEdEhEvAicCfwYmEf5TiYzM6uyMfUcBNCUPPdwJrAoInqBSC0qMzMbUs8Yq0FcATwDtAH3StoXeDGtoMzMbGj5KvVBjLST+mLg4gFFv5H0lnRCMjOz4YypwfokTZX0r31Te0r6F8q1CTMzq7Jq1SBGuvergc3A+5LXi8C30wrKzMyGVq27mEY6YdCrI+LdA5b/SdIjKcRjZmbbMdYG69sq6fi+BUnHAVvTCcnMzIZTrQflRlqD+BDwHUlTk+UNwLnphGRmZsPJF0o0ZzNISvU4I72LaTlwuKQpyfKLkj4O/CLF2MzMrIJ8oZR68xLs4IxyEfFi8kQ1wCdSiMfMzLYjXyyOvQQxSLp1GzMzq6iviSltu3IED7VhZlYD1WpiGrYPQtJmKicCARNTicjMzIbVMxYSRERMTj0CMzPbIfXQxGRmZjWQL47Bu5jMzKz2egql1OeCACcIM7O6MyafgzAzs9rLuwZhZmaVuA/CzMwq8l1MZmZWUd33QUi6WtIaSSsGlM2QdKeklcn79CG2LUp6JHktSitGM7N61AhNTNcAJw8q+xRwV0QcANyVLFeyNSKOSF6npxijmVndKTcxZVM/TmoJIiLuBToHFZ8BXJt8vhY4M63jm5k1qp7C2B/NdWfMjojnk88vALOHWG+CpA5JSyWdOdwOJV2QrNuxdu3a0YzVzGzMKZWC3mI0ZILoFxHB0CPC7hsR7cAHgK9LevUw+7kyItojon3WrFlphGpmNmb0zUfdiM9B/F7SqwCS9zWVVoqIZ5P3VcA9wJHVCtDMbCzrSxCNeJvrIrbNZX0u8F+DV5A0XVJL8nk34DjgV1WL0MxsDMsXkgRRzzUISTcAS4ADJa2WtBD4EvA2SSuBtybLSGqX9M1k04OBDknLgbuBL0WEE4SZGdsSRDWamIadD2JXRMSCIb46qcK6HcB5yecHgdelFZeZWT1riBqEmZmNvv4+CCcIMzMbqL8G0YCd1GZmtgt63MRkZmaVuA/CzMwqquaDcqndxWRjX6kU5IslegolegpFCsXyg+0SCCXvQLKcy4imXIamrGjKZJCgFFCKoBRBDHouPiOREWQzQlLVz8+sEfX0FgGqMlifEwRw38q19PSWKJRK9BaDYilobc4yeUITUybmmNzSRCZTvuD1XefyhfKFNV8oUSgFuYzIZUUuk6FQKrGxu5eN3b1s2pqnO18kXyjRWyyv31sqH6NQDIqlEsUIiqXyBbtQCrb2FujqKdKdL/Rvmy+W6E2O1afvQl6+AL88vj6FYtBbLB+7UCzvv1gKCqUSpaEGOklJNiOySYzZTDnhNOcy5DIZsplXJpCIIIAI+s8vmym/+hJPX1lfcuo7JQGZTPn3yQhIkpXY9jv1J8EBnzMD4ssm+27KZWjOJokxm6Epm0niFrlshmT3/cdqzm1bpzmboaWp/N5XnhuwnwlNGSY2ZZnYlGVCc7a8XjZDpsLvYQbVvYvJCQI4/zsdvNRbqtrxmpJEksuITHKhlEQ2A7lMhtbmbPLKMXtKEy25AReXJBn0XRDL//eevA+64gfl/fVd2PouTH0X52xygW7JZcv7Ty5KfRflIJL38sW6L6nlk4QD22oJGpSc+uIrlqI/tmJfrKVtiSpfLFEoliiWBsYdL6vB9J1vsX8/5X0U+/ZZiuTY5QD61o+kZlMacA6R/FZ951cKiBIEpf7v+n7PYnKMcoKNbYk6Sba9xZcn7NGUzYjmbIa2lixtLTnamnNMaskxacKg95YcbS05Jg/6bnJLjqmtTcxsa6mYfK1+VbMPwgkCuOH8Y5KLZvlims2I7nyRF1/q5cWtBTa/1PuyCwrQf9FuyWXJZuj/v/PeYolcJsP01iamTGxi6sQmJrXk+i/wTVk3tzSaGNC8VowkoRT6mu+21QB7ekv9yaacXMplW3uLdOeLvNRbJN9Xy0zW78qXa5JdPQU2v1RgzeaXWLW2wJZkue+OlqFIMKO1md0mtbD7lBZmTWph1uTya870icyZ3sre01uZMjHnf5d1wgmiyo7cp+LEdmYjMrD2lKFcS6O5OsfuLZb6k0dXvsCWl7Yljw3dedZt7mHtljzrtvSwdnMPq9Z2sXZzT38zRZ/JE3LM262t/7X/7pN4w9wZzJ4yoTonYiNWzcH6nCDM6lhTNsO01mamtY48I0UEm7b2snrDVlZv6OZ3nVv5bWc3z6zvouOZDSxa/lx/jWjuzFbmz5vB/HkzOWa/GcyZ3prSmdhI9STN4S1NThBmNsok9SeVQ/ea+orvX+ot8sQLm3n4mU4eerqTOx79PTd1rAZgzvSJHLPfTE58zSxOOmh32lp8Cam2jVvzZDNiUnP6v73/65rZy0xoynL43tM4fO9pnHfCfpRKwa/XbGbpU+tZuqqTux77PTcvW82Epgx/cNDunHbYnvzBQbszoSn92y4NOrt6md7aVJU73ZwgzGxYmYw4aI8pHLTHFD543DxKpeDhZzq57ZfPs/iXL7D4ly8wb7c2vvKew3jD3Bm1DrfhdXb1MKOtOp1cfpLazHZIJiOO3m8mnzvjUB7625P41rnt9BZLvO+KJXx20aN05wu1DrGhdXblmb4DfU67wgnCzHZaNiNOOng2d3z8RM49di7XPPgM7/j6vXQ801nr0BpWZ1eemZOcIMysTrS15Pjs6a/lpguPJSNx9pVLufr+p4nB46/YLuvsyruJyczqz/x5M1j0Z8fzloN253M/+hUfu/ERunrc5DRaiqVg49ZeZriJyczq0dSJTVzxh6/nk+84kNt+8RxnXvoAjz3/Yq3Daggbu/NE4BqEmdWvTEZ85C37c93Co9nQnef0b9zPpXc/SaFYvTHPGlFnVx6AGZNaqnI8JwgzS81x++/GT/7iTbztkNl89Y4neM/lS3hq7ZZah1W31vclCDcxmVkjmNHWzKUfOIqLFxzJ0+u6OPXf7uO7S3/jDuydsKEvQbiJycwahSROP3xP7vyLEzl6v5n8/Q9XcOF1y/oveDYyfTUI3+ZqZg1n9ykTuOaDb+Dv33kwdz+xhlP+7T6WPLW+1mHVjb6EOq21qSrHc4Iws6rKZMR5J+zHLR8+jtbmLOd8cylX3bvKTU4jsL4rz+SWHC256ox75QRhZjVx6F5TufWjx/OO1+7BFxY/xiduWs5LyXzLVllnV57pVep/ACcIM6uhtpYcl51zFH/5ttdwy8+f5b2XL+G5jVtrHdaYtaG7ek9RgxOEmdWYJD560gFc9cftPL2ui3dd9gCrfCtsReu35JnpBGFm483bDpnNzRcdS6EYLLhqqZNEBW5iMrNx66A9pvC9849xkqggIujsdg3CzMaxA/eY3J8kzr7SSaJPV75IvlBqnD4ISVdLWiNpxYCyGZLulLQyeZ8+xLbnJuuslHRumnGa2djSlySKpeD9Vy7l17/fXOuQaq5zS/kZiEZqYroGOHlQ2aeAuyLiAOCuZPllJM0APgMcDcwHPjNUIjGzxnTgHpO58YJjEPD+K5aw4tlNtQ6ppjq7k6eoGyVBRMS9wOCppc4Ark0+XwucWWHTdwB3RkRnRGwA7uSVicbMGtwBsydz04XH0tqcY8FVS/nZbzfUOqSa6ezqAao3DhPUpg9idkQ8n3x+AZhdYZ29gN8NWF6dlL2CpAskdUjqWLt27ehGamY1N3e3Nr5/4THMaGvmj775EPevXFfrkGqis6sXaPwE0S/Kz9bv0vP1EXFlRLRHRPusWbNGKTIzG0vmTG/lpguPZa/pE/njqx/isnueHHdDc4yXGsTvJb0KIHlfU2GdZ4G9ByzPScrMbJyaPWUCt3z4OE553av4yu1PcMF1y3jxpd5ah1U167vyNGczTGrJVe2YtUgQi4C+u5LOBf6rwjp3AG+XND3pnH57UmZm41hbS45vLDiSfzjtEO5+fA2nX3I/K8fJHU4buvJMb2tCUtWOmfZtrjcAS4ADJa2WtBD4EvA2SSuBtybLSGqX9E2AiOgE/i/wcPL6XFJmZuOcJBYeP48bLjiGLT1Fzvr3B3nwqcbvl+jsyjOjrTpTjfZRI7Xjtbe3R0dHR63DMLMqWb2hmz/59sM8s76LL7/7MM46ak6tQ0rNuy57gLbmHN897+hR3a+kZRHRXuk7P0ltZnVrzvRWbr7ojbTvO4NP3LSci+9a2bCd1xuqPA4TOEGYWZ2bOrGJa/90PmcduRf/euev+cyiRymVGi9JrO+q7jhMANXrDjczS0lzLsO/vO9wZk5q5qr7nqY7X+TL7z6MbKZ6HbppyhdKbH6pUNVbXMEJwswahCT+9tSDaWvJ8fX/XsnW3iJfe98RNOfqv6FkY3f1x2ECJwgzayCS+PhbX0Nbc44vLH6Ml/JFLj3nKCY0VWcO57Ss76r+OEzgPggza0Dnn7gfnz/zUO56fA0XfXdZ3c913ZkkiOmtThBmZrvsD4/Zly+e9TrufmItF313GT2F+k0SfQli5iQnCDOzUbFg/j79SeJD19VvkuhLENXupHaCMLOGtmD+Pvy/d5WTxAXfqc/xm/oSxLSJTVU9rhOEmTW8Dxy9D18663Xc/+Q6zvjGAzz+wou1DmmHdHblmdbaRC5b3Uu2E4SZjQtnz9+HG84/hi09Bc689AFu+fnqWoc0YuVxmKrbvAROEGY2jsyfN4PbPnY8h82Zxl98fzmfu/VXdTE0R2dXnhlVvoMJnCDMbJzZffIErj/vaM49dl+ufuBp/vknT9Q6pO2qVQ3CD8qZ2bjTlM3w2dNfS75Y4tK7n2J6azPnnbBfrcMa0vquPEftO63qx3WCMLNxSRKfP/N1bOzu5fO3Pcb01mbe/fqxN1x4RLChO1/1h+TATUxmNo5lM+LrZx/BcfvP5K//8xf84Gerx1yfxItbCxRL4U5qM7Nqa8llueKP2jl8zlQ+cdNy3v3vD/LwM2NnAsv1XT1A9Z+iBicIMzMmteS46cJj+fK7X8ezG7fy3suXcN61HfxmfVetQ2NDd23GYQInCDMzAHLZDO9/wz7c81dv4ZPvOJCHVq3ntEvu585f/b6mcS165DkA5kyfWPVjO0GYmQ0wsTnLR96yP4v//ATmzmzj/O908JXbH6dYg1nqvvfQb7l2yW9YePw89t99ctWP7wRhZlbB3jNa+Y8PHcuC+Xtz2T1P8cdXP8S6LT1VO/6Sp9bzj/+1gje9ZhafPuWgqh13ICcIM7MhTGjK8sWzDuMr7zmMjmc28M6L7+OhVetTP+5v13dz0fXL2HdmK5d84Miqj8HUxwnCzGw73te+N7d8+Dham3MsuGopl979JKWUmpy29BRYeO3DRMC3zn0DUyZUdwTXgZwgzMxG4JA9p3DrR4/nnYftyVfveII/ueZh1o9yk1NE8Okf/JKn1m7hsnOOYu5ubaO6/x3lBGFmNkKTWnJcfPYRfOFdh7Jk1XreefH9o/rMxPUP/ZZblz/HX779QI7bf7dR2+/OcoIwM9sBkjjn6H35wUVvZEJThrOvXMpl9+x6k9OKZzfxuVt/xZteM4uL3vTqUYp21zhBmJnthEP3msqtHz2eUw7dg6/c/gTnfvt/eHLNlp3a16atvXz4+p8xc1IzX3v/EWQyGuVod44H6zMz20mTJzRxyYIjOWa/mXxx8WO8/Ws/5T2vn8PHTjqAOdNbX7F+sRSsXLOZX6zexLotPfT0lugplOh4ppPnNm7l+xceU5Mxl4biBGFmtgsk8YfH7Msph+7BZfc8xXVLf8MPf/4cJx28OxOaskQEATy/8SVWPLeJ7nzxZds3ZzNMbM7yT2e8ltfvO6M2JzEEjbWRC3dFe3t7dHR01DoMMxvHntu4lUv+/0oeeHLb8xJSeSylI/aexmFzpnLYnGnMmT6R5mym5s1JkpZFRHul71yDMDMbRXtOm8gXzzqs1mGMipp0Ukv6c0krJD0q6eMVvn+zpE2SHkle/1iDMM3MxrWq1yAkHQqcD8wH8sDtkn4UEU8OWvW+iDit2vGZmVlZLWoQBwMPRUR3RBSAnwJn1SAOMzMbRi0SxArgBEkzJbUCpwJ7V1jvWEnLJf1Y0murG6KZmVW9iSkiHpP0ZeAnQBfwCFActNrPgH0jYoukU4EfAgdU2p+kC4ALAPbZZ5+UojYzG39q0kkdEd+KiNdHxInABuDXg75/MSK2JJ8XA02SKg5MEhFXRkR7RLTPmjUr9djNzMaLWt3FtHvyvg/l/ofvDfp+D0lKPs+nHGf6g7CbmVm/Wj0H8Z+SZgK9wEciYqOkDwFExOXAe4CLJBWArcDZ0UhP9JmZ1YGGepJa0iZg5YCiqcCmEX7eDVi3E4cduK8dXWdw+XDL9RD/cHEOXB7N+IeLb3vfby/+wcuVPjv+sRE/jI2/gXr8G54WEZXb5yOiYV7AlUMtb+8z0DEax9yRdYaLtx7jHy7OQbGOWvwjOYedjX+Ev7vjHwPx78o5+G946O0abbjvW4dZHsnn0TjmjqwzXLyDl+sh/sFlQ53PaMY/kn3sbPyDlyt9dvyNH/9w6zTi33C/hmpi2hWSOmKIAavqgeOvLcdfe/V+DmMx/karQeyKK2sdwC5y/LXl+Guv3s9hzMXvGoSZmVXkGoSZmVXkBGFmZhU5QZiZWUVOECMg6QRJl0v6pqQHax3PjpKUkfQFSZdIOrfW8eyoZAKp+5L/Bm+udTw7Q1KbpA5JdTfHiaSDk9/+ZkkX1TqeHSXpTElXSfq+pLfXOp6dIWk/Sd+SdHM1j9vwCULS1ZLWSFoxqPxkSU9IelLSp4bbR0TcFxEfAn4EXJtmvIONRvzAGcAcykObrE4r1kpGKf4AtgATqM/4Af4GuCmdKIc2Sv/+H0v+/b8POC7NeAcbpfh/GBHnAx8C3p9mvJWM0jmsioiF6Ub6Sg1/F5OkEylfXL4TEYcmZVnKI8i+jfIF52FgAZAFvjhoF38aEWuS7W4CFkbE5iqFPyrxJ68NEXGFpJsj4j11Fv+6iChJmg38a0ScU2fxHw7MpJzg1kXEj6oT/ej9+5d0OnARcF1EfI8qGeW/338Bro+In1UpfJLjjuY5VPXvt1aD9VVNRNwrae6g4vnAkxGxCkDSjcAZEfFFoGITQDLy7KZqJgcYnfglraY8vSu8cu6NVI3W75/YALSkEugQRun3fzPQBhwCbJW0OCJKacbdZ7R+/4hYBCySdBuDRl9O0yj9/gK+BPy42skBRv1voKoaPkEMYS/gdwOWVwNHb2ebhcC3U4tox+xo/D8ALpF0AnBvmoGN0A7FL+ks4B3ANOAbqUY2MjsUf0T8HYCkD5LUhlKNbvt29Pd/M+Vh+VuAxWkGNkI7+u//o8BbgamS9o/yiNG1tqP/DWYCXwCOlPTpJJGkbrwmiB0WEZ+pdQw7KyK6KSe4uhQRP6Cc5OpaRFxT6xh2RkTcA9xT4zB2WkRcDFxc6zh2RUSsp9yHUlUN30k9hGd5+TzYc5KyeuH4a8vx11a9xw91cg7jNUE8DBwgaZ6kZuBsYFGNY9oRjr+2HH9t1Xv8UC/nsDPjj9fTC7gBeJ5tt3guTMpPpXwXwVPA39U6Tsdf+1gd/9h71Xv89X4ODX+bq5mZ7Zzx2sRkZmbb4QRhZmYVOUGYmVlFThBmZlaRE4SZmVXkBGFmZhU5QVhDk7SlyscblflCVJ4DY5OkRyQ9LumfR7DNmZIOGY3jm4EThNkOkTTs+GUR8cZRPNx9EXEEcCRwmqTtzcVwJuURY81GhROEjTuSXi3pdknLVJ6p7qCk/P9IekjSzyX9dzL/BJI+K+k6SQ8A1yXLV0u6R9IqSR8bsO8tyfubk+9vTmoA1yfDTiPp1KRsmaSLJQ07P0REbAUeoTwCKJLOl/SwpOWS/lNSq6Q3AqcDX01qHa8e6jzNRsoJwsajK4GPRsTrgb8CLkvK7weOiYgjgRuBvx6wzSHAWyNiQbJ8EOUhyOcDn5HUVOE4RwIfT7bdDzhO0gTgCuCU5PizthespOnAAWwbqv0HEfGGiDgceIzy0A0PUh7L55MRcUREPDXMeZqNiIf7tnFF0iTgjcB/JP9DD9smIZoDfF/Sq4Bm4OkBmy5K/k++z20R0QP0SFoDzOaV06H+T0SsTo77CDCX8sxiqyKib983ABcMEe4JkpZTTg5fj4gXkvJDJX2e8vwYk4A7dvA8zUbECcLGmwywMWnbH+wSylOaLkomyfnsgO+6Bq3bM+Bzkcp/SyNZZzj3RcRpkuYBSyXdFBGPANcAZ0bE8mQSojdX2Ha48zQbETcx2bgSES8CT0t6L5Sno5R0ePL1VLaNyX9uSiE8Aew3YArK929vg6S28SXgb5KiycDzSbPWwPm5Nyffbe88zUbECcIaXauk1QNen6B8UV2YNN88CpyRrPtZyk0yy4B1aQSTNFN9GLg9Oc5mYNMINr0cODFJLP8APAQ8ADw+YJ0bgU8mneyvZujzNBsRD/dtVmWSJkXEluSupkuBlRHxtVrHZTaYaxBm1Xd+0mn9KOVmrStqG45ZZa5BmJlZRa5BmJlZRU4QZmZWkROEmZlV5ARhZmYVOUGYmVlFThBmZlbR/wJh9bA3W1WWiwAAAABJRU5ErkJggg==
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>8.106811</td>
      <td>6.095938</td>
      <td>00:39</td>
    </tr>
    <tr>
      <td>1</td>
      <td>7.586563</td>
      <td>6.031248</td>
      <td>00:39</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">unfreeze</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SuggestedLRs(lr_min=0.02089296132326126, lr_steep=0.17378008365631104)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="mf">5e-5</span><span class="p">,</span> <span class="mf">5e-4</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>7.335484</td>
      <td>6.138623</td>
      <td>00:51</td>
    </tr>
    <tr>
      <td>1</td>
      <td>7.145704</td>
      <td>5.996723</td>
      <td>00:48</td>
    </tr>
    <tr>
      <td>2</td>
      <td>6.942595</td>
      <td>6.087477</td>
      <td>00:47</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we can see, even with extreme measures taken to avoid overfitting such as unfreezing batch/layer norm during fine-tuning, reducing batch size, adding weight decay, and cranking up the learning rate, the model still overfits at practically the first epoch. This probably means that the model architecture itself can be further improved, as well as the augmentation techniques. We shall explore these further in the next section on analysis.</p>
<p>For now, we shall save the model to experiment on the test set.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">model</span>
<span class="n">save_path</span> <span class="o">=</span> <span class="s1">&#39;saved_model.pt&#39;</span>
<span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span> <span class="n">save_path</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

